# 시스템 정의서


## 0. 시스템의 명칭

경부고속도로 실시간 교통정보 시스템


## 1. 시스템의 배경 및 필요성

- 경부고속도로 오산IC-천안IC 구간은 대한민국의 주요 교통 동맥으로, 매일 수많은 차량이 이용하고 있다. 그러나 실시간 교통 상황을 종합적으로 파악하기 어렵고, 돌발 상황이나 정체 구간에 대한 사전 정보 제공이 부족하여 운전자들이 불편을 겪고 있다. 특히 출퇴근 시간대나 주말에는 예측 불가능한 교통 정체가 빈번하게 발생하여 불필요한 시간 낭비와 연료 소비가 발생하고 있다.

- 기존 교통정보 서비스는 단순히 현재 속도만 표시하거나, CCTV 영상만 제공하는 등 산발적인 정보 제공에 그치고 있다. 또한 취약구간(안개, 결빙)이나 위험물질 운송차량 등 안전 관련 정보가 별도로 관리되어 운전자가 종합적인 판단을 내리기 어려운 상황이다. 이로 인해 사고 위험이 증가하고, 교통 흐름의 비효율성이 지속되고 있다.

- 최근 AI 및 머신러닝 기술의 발전으로 교통 패턴을 분석하고 미래 교통 상황을 예측하는 것이 가능해졌다. XGBoost와 같은 머신러닝 모델을 활용하면 과거 교통 데이터를 학습하여 시간대별, 요일별 교통 속도를 정확하게 예측할 수 있으며, 이를 통해 운전자는 출발 전 경로를 미리 계획할 수 있다. 또한 ITS Open API를 통해 실시간 교통정보, CCTV 영상, 돌발상황 등을 통합하여 제공할 수 있는 인프라가 구축되어 있다.

- 이러한 배경으로, 경부고속도로 오산IC-천안IC 구간의 실시간 교통 상황을 모니터링하고, AI 기반 예측을 통해 운전자에게 종합적인 교통정보를 제공하는 웹 기반 시스템을 개발함으로써, 교통 안전성을 향상시키고, 운전자의 의사결정을 지원하며, 전체적인 교통 흐름의 효율성을 개선하고자 한다.


## 2. 시스템의 목표

경부고속도로 오산IC-천안IC 구간의 실시간 교통 데이터를 수집하고, XGBoost 기반 AI 모델을 활용한 교통 속도 예측, CCTV 영상 스트리밍, 안전정보 제공 기능을 통합한 웹 기반 실시간 교통정보 시스템을 개발하여, 운전자의 안전하고 효율적인 도로 이용을 지원하는 것을 목표로 한다.


## 3. 시스템의 기술

### 3.1 컨텍스트 다이어그램

경부고속도로 실시간 교통정보 시스템은 오산IC-천안IC 구간의 교통 속도, CCTV 영상, 돌발상황, 취약구간 정보를 통합하여 사용자에게 제공하는 시스템이다.

시스템은 ITS Open API를 통해 한국도로공사로부터 실시간 교통속도, CCTV 영상 스트림, 돌발상황, VMS 전광판 메시지, 위험물질 운송차량 위치 정보를 수집한다. 또한 행정안전부 공공데이터로부터 안개 취약구간 및 결빙 취약구간 정보를 CSV 파일 형태로 저장하여 활용한다.

사용자(운전자 및 교통정보 관심자)는 웹 브라우저를 통해 시스템에 접속하여 실시간 교통 지도, CCTV 영상, AI 교통 예측 결과, 안전정보를 조회할 수 있다. 시스템은 Node.js 기반 Express 서버를 통해 API 엔드포인트를 제공하며, Python AI 서버는 XGBoost 모델을 활용하여 교통 속도를 예측한다.

```
┌──────────────────────────────────────────────────────────────────┐
│                          외부 데이터 소스                          │
├──────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────┐  ┌─────────────────────────────────┐   │
│  │  ITS Open API       │  │  행정안전부 공공데이터           │   │
│  │  (한국도로공사)      │  │  - 안개 취약구간                │   │
│  │  - 교통속도          │  │  - 결빙 취약구간                │   │
│  │  - CCTV 영상        │  │                                 │   │
│  │  - 돌발상황          │  │                                 │   │
│  │  - VMS 전광판       │  │                                 │   │
│  │  - 위험물질 차량     │  │                                 │   │
│  └─────────────────────┘  └─────────────────────────────────┘   │
└──────────────────┬───────────────────────┬───────────────────────┘
                   │                       │
                   │ API 호출               │ CSV 파일
                   │                       │
         ┌─────────▼───────────────────────▼──────────────────┐
         │    경부고속도로 실시간 교통정보 시스템              │
         │                                                     │
         │  ┌──────────────────────────────────────────────┐  │
         │  │         Node.js Express 서버                 │  │
         │  │  - REST API 제공                             │  │
         │  │  - ITS API 연동                             │  │
         │  │  - CSV 데이터 처리                           │  │
         │  └──────────────┬───────────────────────────────┘  │
         │                 │                                   │
         │  ┌──────────────▼───────────────────────────────┐  │
         │  │         Python AI 서버                       │  │
         │  │  - XGBoost 교통 예측 모델                    │  │
         │  │  - 11,004건 교통 데이터 학습                 │  │
         │  │  - 12시간 교통 예보 생성                     │  │
         │  └──────────────────────────────────────────────┘  │
         └─────────────────────┬───────────────────────────────┘
                               │
                               │ HTTP/REST API
                               │
         ┌─────────────────────▼───────────────────────────────┐
         │                사용자 (웹 브라우저)                  │
         │  ┌──────────────────────────────────────────────┐  │
         │  │         프론트엔드 (HTML/CSS/JS)             │  │
         │  │  - Leaflet.js 지도                          │  │
         │  │  - Chart.js 데이터 시각화                   │  │
         │  │  - 실시간 교통 모니터링                     │  │
         │  │  - CCTV 영상 재생                           │  │
         │  │  - AI 예측 결과 표시                        │  │
         │  └──────────────────────────────────────────────┘  │
         └─────────────────────────────────────────────────────┘
```


### 3.2 서비스 시나리오

경부고속도로 실시간 교통정보 시스템은 실시간 교통 모니터링, AI 교통 예측, CCTV 영상 조회, 안전정보 제공 등을 다루는 시스템이다. 이 시스템의 핵심 업무인 실시간 교통 조회 및 AI 예측 업무를 중심으로 업무처리 시나리오를 설명하면 다음과 같다.


#### 1) 실시간 교통 모니터링 업무

- 사용자가 웹 브라우저를 통해 시스템에 접속한다.
- 시스템은 홈 화면에서 현재 도로 상황 요약 정보(평균 속도, 예상 소요시간, 도로 안전 지수)를 표시한다.
- 사용자가 "실시간 교통" 메뉴를 선택한다.
- 시스템은 OpenStreetMap 기반 Leaflet 지도를 로드하고, 오산IC-천안IC 구간을 표시한다.
- 시스템은 30초마다 자동으로 `/api/traffic` API를 호출하여 실시간 교통 속도 데이터를 갱신한다.
- 교통 데이터는 `history.csv` 파일에서 현재 요일 및 시간대에 해당하는 데이터를 조회하여 제공된다.
- 지도상에 구간별 CCTV 위치가 원형 마커로 표시되며, 속도에 따라 색상이 구분된다:
  - 녹색: 80 km/h 이상 (원활)
  - 노란색: 40-80 km/h (서행)
  - 빨간색: 40 km/h 미만 (정체)
- 사용자가 지도상의 마커를 클릭하면 해당 지점의 상세 정보(지점명, 평균 속도, 소통 상태)가 팝업으로 표시된다.
- 사용자는 "돌발상황 표시", "VMS 표시", "위험물질 차량" 체크박스를 활성화하여 추가 정보를 지도에 표시할 수 있다.


#### 2) AI 교통 예측 업무

- 사용자가 "CCTV" 메뉴를 선택한다.
- 시스템은 CCTV 목록을 드롭다운 메뉴로 표시한다 (오산IC, 입장휴게소, 천안IC 등).
- 사용자가 특정 CCTV를 선택한다 (예: 오산IC).
- 시스템은 선택된 CCTV의 영상 스트림을 `<video>` 태그를 통해 재생한다.
- 동시에 시스템은 `/api/predict?id=2` API를 호출하여 해당 구간의 AI 교통 예측을 요청한다.
- 백엔드 서버는 Python Child Process를 생성하여 `ai_server.py`를 실행한다.
- Python AI 서버는 다음 단계를 수행한다:
  1. `history.csv` 파일을 로드하여 11,004건의 교통 데이터를 읽는다.
  2. XGBoost 모델을 생성하고, 요일(day)과 시간(hour)을 입력 변수로 하여 속도(speed)를 예측하도록 학습한다.
  3. 현재 시간 기준 1시간 후의 교통 속도를 예측한다.
  4. 예측된 속도에 따라 위험도를 계산한다:
     - 40 km/h 미만: "🟥 정체 예상"
     - 40-80 km/h: "🟨 서행 예상"
     - 80 km/h 이상: "🟩 원활 예상"
  5. 향후 12시간의 교통 예보를 생성한다.
  6. 결과를 JSON 형태로 stdout에 출력한다.
- 백엔드 서버는 Python 프로세스의 stdout을 캡처하여 JSON을 파싱한 후 클라이언트에 응답한다.
- 프론트엔드는 AI 분석 결과를 화면에 표시한다:
  - 위험도 (원활/서행/정체)
  - 예측 속도 (km/h)
  - 평소 평균 속도와의 비교
  - 향후 12시간 교통 예보 (Chart.js 라인 차트)
- 사용자는 예측 결과를 바탕으로 출발 시간을 조정하거나 경로를 변경할 수 있다.


#### 3) 안전정보 조회 업무

- 사용자가 "안전정보" 메뉴를 선택한다.
- 시스템은 4가지 탭을 표시한다: [돌발상황] [취약구간] [VMS] [위험물질 차량].
- 사용자가 "돌발상황" 탭을 선택한다.
- 시스템은 `/api/warnings` API를 호출하여 ITS Open API로부터 실시간 돌발상황 정보를 조회한다.
- 돌발상황 목록이 리스트 형태로 표시된다 (예: "⚠️ 차량 고장 - 오산IC 부근").
- 사용자가 "취약구간" 탭을 선택한다.
- 시스템은 `/api/vulnerable` API를 호출하여 CSV 파일에서 안개 및 결빙 취약구간 데이터를 조회한다.
- 안개 취약구간은 경부고속도로 200-320km 구간 중 해당하는 구간을 필터링하여 표시한다.
- 결빙 취약구간은 위도 36.8-37.3, 경도 126.9-127.3 범위 내의 구간을 필터링하여 표시한다.
- 각 취약구간에는 아이콘과 함께 주의 메시지가 표시된다:
  - 안개: "🌫️ 안개 - 가시거리 주의"
  - 결빙: "❄️ 결빙 - 미끄럼 주의"
- 사용자는 현재 도로 상황과 취약구간 정보를 종합하여 안전 운전 계획을 수립한다.


#### 4) CCTV 영상 실시간 조회 업무

- 사용자가 실시간 교통 상황을 직접 눈으로 확인하고자 한다.
- 사용자가 "CCTV" 메뉴를 선택하고, 드롭다운에서 "천안IC"를 선택한다.
- 시스템은 `/api/cctv/list` API를 호출하여 ITS Open API로부터 CCTV 목록 및 스트리밍 URL을 조회한다.
- 시스템은 천안IC CCTV의 스트리밍 URL을 `<video>` 태그에 설정하여 실시간 영상을 재생한다.
- 사용자는 CCTV 영상을 통해 실제 도로 상황(차량 밀집도, 날씨 상태 등)을 직접 확인한다.
- 영상 재생 중 CORS 정책으로 인해 일부 CCTV 영상이 재생되지 않을 수 있으며, 이 경우 "영상을 불러올 수 없습니다" 메시지가 표시된다.


#### 5) VMS 전광판 정보 조회 업무

- 사용자가 도로 전광판에 표시되는 실시간 메시지를 확인하고자 한다.
- 사용자가 "안전정보" 메뉴의 "VMS" 탭을 선택한다.
- 시스템은 `/api/vms` API를 호출하여 ITS Open API로부터 VMS 전광판 정보를 조회한다.
- VMS 메시지 목록이 표시된다 (예: "📋 앞 2km 사고 발생, 서행 - 오산IC 부근").
- 사용자는 VMS 메시지를 확인하여 전방 도로 상황을 미리 파악하고 속도를 조절한다.


## 4. 운영 환경

### 4.1 시스템 운영 환경

**서버 환경:**
- 운영체제: Windows 10/11, Linux (Ubuntu 20.04 이상), macOS
- 런타임: Node.js v14.x 이상, Python 3.7 이상
- 웹 서버: Express.js v4.18
- 포트: HTTP 3000번 포트

**클라이언트 환경:**
- 웹 브라우저: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- 네트워크: 인터넷 연결 필수 (ITS Open API 및 지도 타일 로드를 위함)
- 화면 해상도: 최소 1280x720 권장

**데이터 소스:**
- ITS Open API: 한국도로공사 제공, HTTPS 프로토콜
- 공공데이터포털: 행정안전부 제공, CSV 파일 형태


### 4.2 사용자 특성

**주요 사용자:**
- 경부고속도로 오산IC-천안IC 구간 이용 운전자
- 교통 상황을 사전에 파악하여 출발 시간을 조정하려는 사용자
- 교통 데이터 분석 및 연구에 관심이 있는 일반 사용자

**기술 수준:**
- 컴퓨터에 대한 전문 지식이 없는 일반 사용자
- 웹 브라우저를 사용하여 인터넷 검색 및 웹사이트 이용 가능한 수준
- 지도 서비스(네이버 지도, 카카오맵 등) 사용 경험이 있는 수준

**접근성:**
- 웹 브라우저만 있으면 언제 어디서나 접근 가능
- 별도의 소프트웨어 설치나 회원가입 불필요
- 직관적인 UI/UX로 초기 학습 시간 최소화
