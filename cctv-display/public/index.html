<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Traffic AI Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="logo-area"><span class="icon">🚔</span><h1>Traffic AI Center</h1></div>
        <nav class="gnb"><ul><li><a href="#" class="active">통합 관제</a></li><li><a href="#">AI 분석</a></li></ul></nav>
        <div class="status-area"><span id="current-time">00:00:00</span> <span class="system-status">● ONLINE</span></div>
    </header>
    <main class="dashboard-grid">
        <section class="cctv-section">
            <div class="card cctv-card">
                <div class="card-header">
                    <div class="selector-area">
                        <span class="label">📡 관제 지점:</span>
                        <input type="text" id="cctv-search" placeholder="검색" onkeyup="filterCCTV()">
                        <select id="cctv-selector" onchange="changeCCTV()"><option>로딩 중...</option></select>
                    </div>
                    <span class="badge live">LIVE FEED</span>
                </div>
                <div id="video-container" class="video-container"></div>
                <div class="ai-info">
                    <div class="info-item"><span class="label">AI 위험도 분석</span><span class="value safe" id="ai-risk">대기 중...</span></div>
                    <div class="info-item"><span class="label">AI 예측 속도 (1시간 후)</span><span class="value" id="ai-speed">-- km/h</span></div>
                </div>
            </div>
        </section>

        <section class="info-section">
            <div class="card map-card">
                <div class="card-header"><h3>🗺️ GIS 위치 관제</h3><div class="toggle-group"><label class="toggle-switch"><input type="checkbox" id="warn-toggle" checked onchange="toggleLayer('warn')"><span class="slider"></span><span>⚠️주의</span></label><label class="toggle-switch"><input type="checkbox" id="traffic-toggle" checked onchange="toggleLayer('traffic')"><span class="slider round" style="background:#ddd;"></span><span>🚦소통</span></label><label class="toggle-switch"><input type="checkbox" id="vms-toggle" checked onchange="toggleLayer('vms')"><span class="slider round" style="background:#ddd;"></span><span>📟VMS</span></label></div></div>
                <div id="map"></div>
            </div>
            
            <div class="card ai-insight-card">
                <div class="card-header" style="background: #2c3e50;">
                    <h3 style="color:white;">🧠 AI 패턴 분석 (평소 vs 현재)</h3>
                    <span class="rec-dot" style="color:#00ff00; border-color:#00ff00;">● MONITORING</span>
                </div>
                <div class="insight-container" style="display: flex; flex-direction: column; justify-content: center; height: 100%; padding: 15px;">
                    <div style="display: flex; justify-content: space-around; align-items: center; margin-bottom: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 0.8rem; color: #888;">AI 평소 패턴</div>
                            <div id="disp-ai-normal" style="font-size: 1.8rem; font-weight: bold; color: #333;">--</div>
                            <div style="font-size: 0.8rem;">km/h</div>
                        </div>
                        <div style="font-size: 2rem; color: #ccc;">VS</div>
                        <div style="text-align: center;">
                            <div style="font-size: 0.8rem; color: #888;">현재 실시간</div>
                            <div id="disp-real-speed" style="font-size: 1.8rem; font-weight: bold; color: #0066ff;">--</div>
                            <div style="font-size: 0.8rem;">km/h</div>
                        </div>
                    </div>
                    <div id="analysis-result" style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #ddd;">
                        <div style="font-weight: bold; font-size: 1.1rem; margin-bottom: 5px;">데이터 수집 중...</div>
                        <div style="font-size: 0.9rem; color: #666;">잠시만 기다려주세요.</div>
                    </div>
                </div>
            </div>
        </section>
        
        <div class="bottom-section">
            <div class="card" style="flex: 1.2;">
                <div class="card-header"><h3>📈 AI 미래 교통 예보 (12시간)</h3><span class="badge" style="background:#0066ff;">PREDICTION</span></div>
                <div style="height: 100%; padding: 10px;"><canvas id="forecastChart"></canvas></div>
            </div>
            <div class="card" style="flex: 0.8;">
                <div class="card-header"><h3>📊 실시간 구간 평균 속도</h3><span class="badge" style="background:#28a745;">REAL-TIME</span></div>
                <div style="height: 100%; padding: 10px;"><canvas id="trafficChart"></canvas></div>
            </div>
        </div>
    </main>
    <script src="script.js"></script>
</body>
</html>